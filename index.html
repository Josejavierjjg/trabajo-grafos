<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de GestiÃ³n Integral</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; background-color: #f4f4f4; }
        header { background: #2c3e50; color: #fff; padding: 1rem; text-align: center; }
        nav { background: #34495e; display: flex; justify-content: center; gap: 20px; padding: 10px; }
        nav button { background: none; color: white; border: none; cursor: pointer; font-size: 16px; font-weight: bold; }
        nav button:hover { text-decoration: underline; color: #18bc9c; }
        
        .container { padding: 20px; max-width: 900px; margin: auto; }
        .module { background: white; padding: 25px; margin-bottom: 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .hidden { display: none; }
        
        h2 { color: #2c3e50; border-bottom: 2px solid #18bc9c; padding-bottom: 5px; }
        
        form { display: grid; gap: 12px; max-width: 400px; margin-bottom: 20px; }
        input, select { padding: 8px; border: 1px solid #ccc; border-radius: 4px; }
        button.action-btn { padding: 10px; background: #18bc9c; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; }
        button.action-btn:hover { background: #128f76; }
        
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
        th { background-color: #ecf0f1; color: #2c3e50; }
    </style>
</head>
<body>

    <header>
        <h1>Panel de AdministraciÃ³n</h1>
    </header>

    <nav>
        <button onclick="showModule('inventario')">ðŸ“¦ Inventario</button>
        <button onclick="showModule('facturacion')">ðŸ§¾ FacturaciÃ³n y Cobro</button>
        <button onclick="showModule('nomina')">ðŸ‘¥ NÃ³mina</button>
    </nav>

    <div class="container">
        
        <section id="inventario" class="module">
            <h2>GestiÃ³n de Inventario</h2>
            <form id="form-inventario">
                <input type="text" placeholder="CÃ³digo del Producto" required>
                <input type="text" placeholder="Nombre del Producto" required>
                <input type="number" placeholder="Precio Unitario" step="0.01" required>
                <input type="number" placeholder="Cantidad en Stock" required>
                <button type="button" class="action-btn" id="btn-add-inventario">Agregar al Inventario</button>
            </form>

            <table>
                <thead>
                    <tr>
                        <th>CÃ³digo</th>
                        <th>Producto</th>
                        <th>Precio</th>
                        <th>Stock</th>
                    </tr>
                </thead>
                <tbody>
                    </tbody>
            </table>
        </section>

        <section id="facturacion" class="module hidden">
            <h2>FacturaciÃ³n y Cobranza</h2>
            <form id="form-facturacion">
                <input type="text" placeholder="Nombre del Cliente" id="nombre-cliente" required>
                <select id="select-productos">
                    <option value="">-- Seleccionar Producto --</option>
                </select>
                <input type="number" placeholder="Cantidad" min="1" value="1" required>
                <button type="button" class="action-btn" id="btn-add-factura">AÃ±adir a la Factura</button>
            </form>

            <table>
                <thead>
                    <tr>
                        <th>Producto</th>
                        <th>Cantidad</th>
                        <th>Precio Unit.</th>
                        <th>Subtotal</th>
                    </tr>
                </thead>
                <tbody>
                    </tbody>
            </table>
            <h3 style="text-align: right;" id="total-cobrar">Total a Cobrar: $0.00</h3>
            <button type="button" class="action-btn" id="btn-procesar-cobro" style="width: 100%; background-color: #e74c3c;">Procesar Cobro</button>
        </section>

        <section id="nomina" class="module hidden">
            <h2>CÃ¡lculo de NÃ³mina</h2>
            <form id="form-nomina">
                <input type="text" placeholder="Nombre del Empleado" required>
                <input type="text" placeholder="Cargo" required>
                <input type="number" placeholder="Salario Base" step="0.01" required>
                <input type="number" placeholder="Bonificaciones" step="0.01" value="0">
                <input type="number" placeholder="Deducciones" step="0.01" value="0">
                <button type="button" class="action-btn" id="btn-add-nomina">Calcular y Registrar Pago</button>
            </form>

            <table>
                <thead>
                    <tr>
                        <th>Empleado</th>
                        <th>Cargo</th>
                        <th>Salario Base</th>
                        <th>Neto a Pagar</th>
                    </tr>
                </thead>
                <tbody>
                    </tbody>
            </table>
        </section>

    </div>

    <script>
        // --- BASES DE DATOS TEMPORALES ---
        let inventario = [];
        let facturaActual = [];
        let nominas = [];

        // --- NAVEGACIÃ“N ---
        function showModule(moduleId) {
            document.querySelectorAll('.module').forEach(mod => mod.classList.add('hidden'));
            document.getElementById(moduleId).classList.remove('hidden');
        }

        // --- 1. LÃ“GICA DE INVENTARIO ---
        document.getElementById('btn-add-inventario').addEventListener('click', function() {
            const inputs = document.querySelectorAll('#form-inventario input');
            const codigo = inputs[0].value;
            const nombre = inputs[1].value;
            const precio = parseFloat(inputs[2].value);
            const stock = parseInt(inputs[3].value);

            if(codigo && nombre && !isNaN(precio) && !isNaN(stock)) {
                inventario.push({ codigo, nombre, precio, stock });
                actualizarTablaInventario();
                actualizarSelectFacturacion();
                document.getElementById('form-inventario').reset(); 
            } else {
                alert('Por favor, completa todos los campos correctamente.');
            }
        });

        function actualizarTablaInventario() {
            const tbody = document.querySelector('#inventario tbody');
            tbody.innerHTML = ''; 
            inventario.forEach(producto => {
                tbody.innerHTML += `
                    <tr>
                        <td>${producto.codigo}</td>
                        <td>${producto.nombre}</td>
                        <td>$${producto.precio.toFixed(2)}</td>
                        <td>${producto.stock}</td>
                    </tr>
                `;
            });
        }

        // --- 2. LÃ“GICA DE FACTURACIÃ“N ---
        function actualizarSelectFacturacion() {
            const select = document.getElementById('select-productos');
            select.innerHTML = '<option value="">-- Seleccionar Producto --</option>'; 
            inventario.forEach(producto => {
                // Solo mostrar productos con stock mayor a 0
                if(producto.stock > 0) {
                    select.innerHTML += `<option value="${producto.codigo}">${producto.nombre} - $${producto.precio.toFixed(2)} (Stock: ${producto.stock})</option>`;
                }
            });
        }

        // AÃ±adir producto a la factura
        document.getElementById('btn-add-factura').addEventListener('click', function() {
            const select = document.getElementById('select-productos');
            const cantidadInput = document.querySelectorAll('#form-facturacion input')[1];
            const cantidad = parseInt(cantidadInput.value);
            const codigoSeleccionado = select.value;
            const producto = inventario.find(p => p.codigo === codigoSeleccionado);

            if(producto && cantidad > 0) {
                if(cantidad > producto.stock) {
                    alert('No hay suficiente stock para esta venta.');
                    return;
                }

                // Restar stock y calcular subtotal
                producto.stock -= cantidad; 
                const subtotal = producto.precio * cantidad;
                facturaActual.push({ nombre: producto.nombre, cantidad, precio: producto.precio, subtotal });
                
                actualizarTablaInventario(); 
                actualizarSelectFacturacion();
                actualizarTablaFacturacion();
            } else {
                alert('Selecciona un producto vÃ¡lido y una cantidad mayor a 0.');
            }
        });

        function actualizarTablaFacturacion() {
            const tbody = document.querySelector('#facturacion tbody');
            tbody.innerHTML = '';
            let totalCobrar = 0;

            facturaActual.forEach(item => {
                totalCobrar += item.subtotal;
                tbody.innerHTML += `
                    <tr>
                        <td>${item.nombre}</td>
                        <td>${item.cantidad}</td>
                        <td>$${item.precio.toFixed(2)}</td>
                        <td>$${item.subtotal.toFixed(2)}</td>
                    </tr>
                `;
            });
            document.getElementById('total-cobrar').innerText = `Total a Cobrar: $${totalCobrar.toFixed(2)}`;
        }

        // Procesar el cobro final
        document.getElementById('btn-procesar-cobro').addEventListener('click', function() {
            const cliente = document.getElementById('nombre-cliente').value;
            
            if(facturaActual.length === 0) {
                alert('La factura estÃ¡ vacÃ­a. AÃ±ade productos antes de cobrar.');
                return;
            }
            if(cliente === "") {
                alert('Por favor, ingresa el nombre del cliente.');
                return;
            }

            const total = document.getElementById('total-cobrar').innerText;
            alert(`âœ… Â¡Cobro procesado con Ã©xito a ${cliente}!\n\n${total}`);
            
            // Limpiar la factura para el siguiente cliente
            facturaActual = [];
            actualizarTablaFacturacion();
            document.getElementById('form-facturacion').reset();
            actualizarSelectFacturacion(); // Refrescar los selectores
        });

        // --- 3. LÃ“GICA DE NÃ“MINA ---
        document.getElementById('btn-add-nomina').addEventListener('click', function() {
            const inputs = document.querySelectorAll('#form-nomina input');
            const empleado = inputs[0].value;
            const cargo = inputs[1].value;
            const salario = parseFloat(inputs[2].value);
            
            // Si el campo de bono/deducciÃ³n estÃ¡ vacÃ­o, lo tomamos como 0
            const bonos = parseFloat(inputs[3].value) || 0;
            const deducciones = parseFloat(inputs[4].value) || 0;

            if(empleado && cargo && !isNaN(salario)) {
                // CÃ¡lculo matemÃ¡tico de la nÃ³mina
                const netoPagar = salario + bonos - deducciones;
                
                nominas.push({ empleado, cargo, salario, netoPagar });
                actualizarTablaNomina();
                document.getElementById('form-nomina').reset(); // Limpiar formulario
            } else {
                alert('Por favor, llena al menos el Empleado, Cargo y Salario Base.');
            }
        });

        function actualizarTablaNomina() {
            const tbody = document.querySelector('#nomina tbody');
            tbody.innerHTML = ''; 
            nominas.forEach(registro => {
                tbody.innerHTML += `
                    <tr>
                        <td>${registro.empleado}</td>
                        <td>${registro.cargo}</td>
                        <td>$${registro.salario.toFixed(2)}</td>
                        <td><strong>$${registro.netoPagar.toFixed(2)}</strong></td>
                    </tr>
                `;
            });
        }
    </script>
</body>
</html>
